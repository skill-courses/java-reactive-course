# Project Reactor

![project-reactor](../images/project-reactive.jpg)

通过前面一节的学习，我们知道Java9里面引入了标准的Reactive Stream API，即`java.util.concurrent.Flow`这个类。这个类里面规定了 Java 响应式编程所要实现的接口与抽象。但是这里大家可能会发现两个问题：

1. Java 9仅仅提供了API，自带的实现非常粗糙，很难基于此构建一个真正的响应式系统。
2. Java 8提供了流式编程，很多项目是基于Java 8构建的，那么如何兼容Java 8这个版本呢？

所以，响应式编程并不是只针对系统中的某一组件，而是需要适用于调用链路上的所有组件，只要有一个环节不是响应式的，那么这个环节就会出现同步阻塞！

Spring官方敏锐的发现了这两个问题，于是启动了Project Reactor项目:[Reactor](https://github.com/reactor).

Reactor 项目主要包含 Reactor Core 和 Reactor Netty 两部分。Reactor Core 实现了反应式编程的核心功能，Reactor Netty 则是 Spring WebFlux 等技术的基础。目前最新的3.X版本以Java 8作为基线，成为了业界最先进的响应式库。

## 引入Reactor

如果你的项目使用的是Gradle，那么你可以非常轻松的引入他们！

```gradle
compile "io.projectreactor:reactor-core:3.6.0-SNAPSHOT" // 包含了Reactor的核心功能
testCompile "io.projectreactor:reactor-test:3.6.0-SNAPSHOT" // Reactor的测试框架
```

## Flux 和 Mono

Reactor框架中最核心的就是代表异步数据序列的Flux和Mono组件，在该框架中，扮演着Publiser的角色，接下来我们就详细了解他们！

在正式开始之前，我们先来了解一种表示异步数据流的图--`弹珠图`,改图能将数据流的转换以可视化的方式呈现出来，他们对于描述操作符的行为非常有效。在Reactor响应式框架中，几乎所有的操作都包含了带有对应弹珠图的说明！

弹珠图最简单的形式就是，在最上面画出数据流经 Flux 或是 Mono 的时间线，在中间画出操作，在最下面画出 Flux 或是 Mono 结果的时间线。例如：

![marble-diagram](../images/marble-diagram.jpg)

### Flux

Flux 是一个发出(emit)0-N个元素组成的异步序列的Publisher<T>,可以被onComplete信号或者onError信号所终止。

![flux-diagram](../images/flux-diagram.svg)

#### Flux的创建

如果你要创建Flux类型的响应式流，总共有两种方法：一种是基于各种工厂模式的静态创建方法，而另一类是采用编程的方式动态的创建Flux。

**静态创建Flux的方法包括：**
1. **just(T... data)**: 该方法接受一个可变数组，可以创建指定序列中包含的全部元素。一般情况下，在元素的数量和内容已知的情况下，该方法是创建Flux最简单的方法。
2. **range(int start, int count)**: 如果你想快速生成一个整数数据流，可以使用该方法，该方法允许我们指定目标整数数据流的起始元素以及所包含的个数，序列中的所有对象的类型都是Integer。
3. **interval(Duration delay, Duration period)**: 该方法在订阅者发布请阅请求后，指定延时一定的时间再发送元素，同时还可以指定元素之间的时间间隔。
4. **fromXXX()**：该类方法都是以from关键字作为前缀。当你已经有了一个数组，一个Iterable对象或Stream对象的时候，使用该方法就可以创建一个Flux响应式序列。

例如：
```java
Flux<String> strFlux = Flux.just("zhangsan", "lisi");
Flux<Integer> fluxRange = Flux.range(0, 20);
Flux<Long> intervalFlux = Flux.interval(Duration.of(3, SECONDS), Duration.of(1, SECONDS));
Flux<String> listFlux = Flux.fromIterable(List.of("zhangsan", "list"));
```

**动态创建Flux的方法包括：**







